machine:
  pre:
    - mkdir -p rust-setup
    - curl -sS https://static.rust-lang.org/rustup.sh > rust-setup/rustup.sh
    - chmod +x rust-setup/rustup.sh
    - rust-setup/rustup.sh --yes

dependencies:
  override:
    - eval `ssh-agent` && ssh-add /home/ubuntu/.ssh/id_circleci_github && cargo build

  cache_directories:
    - "/home/ubuntu/rust-setup"

test:
  override:
    - eval `ssh-agent` && ssh-add /home/ubuntu/.ssh/id_circleci_github && cargo test

# deployment:
#   deploy:
#     branch: [develop, master]
#     commands:
#       - cargo deploy

